(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.HeliaCar = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var HeliaCar=(()=>{var _n=Object.create;var $e=Object.defineProperty;var kn=Object.getOwnPropertyDescriptor;var En=Object.getOwnPropertyNames;var Tn=Object.getPrototypeOf,An=Object.prototype.hasOwnProperty;var In=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Sn=(t,e)=>{for(var r in e)$e(t,r,{get:e[r],enumerable:!0})},Pt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of En(e))!An.call(t,o)&&o!==r&&$e(t,o,{get:()=>e[o],enumerable:!(n=kn(e,o))||n.enumerable});return t};var Bn=(t,e,r)=>(r=t!=null?_n(Tn(t)):{},Pt(e||!t||!t.__esModule?$e(r,"default",{value:t,enumerable:!0}):r,t)),Un=t=>Pt($e({},"__esModule",{value:!0}),t);var Mt=In((ti,it)=>{"use strict";var zn=Object.prototype.hasOwnProperty,E="~";function we(){}Object.create&&(we.prototype=Object.create(null),new we().__proto__||(E=!1));function Ln(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Lt(t,e,r,n,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var i=new Ln(r,n||t,o),a=E?E+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],i]:t._events[a].push(i):(t._events[a]=i,t._eventsCount++),t}function De(t,e){--t._eventsCount===0?t._events=new we:delete t._events[e]}function k(){this._events=new we,this._eventsCount=0}k.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)zn.call(r,n)&&e.push(E?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};k.prototype.listeners=function(e){var r=E?E+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a};k.prototype.listenerCount=function(e){var r=E?E+e:e,n=this._events[r];return n?n.fn?1:n.length:0};k.prototype.emit=function(e,r,n,o,i,a){var c=E?E+e:e;if(!this._events[c])return!1;var f=this._events[c],p=arguments.length,w,m;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),p){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,r),!0;case 3:return f.fn.call(f.context,r,n),!0;case 4:return f.fn.call(f.context,r,n,o),!0;case 5:return f.fn.call(f.context,r,n,o,i),!0;case 6:return f.fn.call(f.context,r,n,o,i,a),!0}for(m=1,w=new Array(p-1);m<p;m++)w[m-1]=arguments[m];f.fn.apply(f.context,w)}else{var ie=f.length,ee;for(m=0;m<ie;m++)switch(f[m].once&&this.removeListener(e,f[m].fn,void 0,!0),p){case 1:f[m].fn.call(f[m].context);break;case 2:f[m].fn.call(f[m].context,r);break;case 3:f[m].fn.call(f[m].context,r,n);break;case 4:f[m].fn.call(f[m].context,r,n,o);break;default:if(!w)for(ee=1,w=new Array(p-1);ee<p;ee++)w[ee-1]=arguments[ee];f[m].fn.apply(f[m].context,w)}}return!0};k.prototype.on=function(e,r,n){return Lt(this,e,r,n,!1)};k.prototype.once=function(e,r,n){return Lt(this,e,r,n,!0)};k.prototype.removeListener=function(e,r,n,o){var i=E?E+e:e;if(!this._events[i])return this;if(!r)return De(this,i),this;var a=this._events[i];if(a.fn)a.fn===r&&(!o||a.once)&&(!n||a.context===n)&&De(this,i);else{for(var c=0,f=[],p=a.length;c<p;c++)(a[c].fn!==r||o&&!a[c].once||n&&a[c].context!==n)&&f.push(a[c]);f.length?this._events[i]=f.length===1?f[0]:f:De(this,i)}return this};k.prototype.removeAllListeners=function(e){var r;return e?(r=E?E+e:e,this._events[r]&&De(this,r)):(this._events=new we,this._eventsCount=0),this};k.prototype.off=k.prototype.removeListener;k.prototype.addListener=k.prototype.on;k.prefixed=E;k.EventEmitter=k;typeof it<"u"&&(it.exports=k)});var qo={};Sn(qo,{car:()=>Go});function Nn(t){return t[Symbol.asyncIterator]!=null}function Cn(t){if(Nn(t))return(async()=>{for await(let e of t);})();for(let e of t);}var $t=Cn;function Pn(t){let[e,r]=t[Symbol.asyncIterator]!=null?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}var Dt=Pn;function $n(t){return t[Symbol.asyncIterator]!=null}function Dn(t,e){if($n(t))return async function*(){for await(let c of t)yield e(c)}();let r=Dt(t),{value:n,done:o}=r.next();if(o===!0)return function*(){}();let i=e(n);if(typeof i.then=="function")return async function*(){yield await i;for await(let c of r)yield e(c)}();let a=e;return function*(){yield i;for(let c of r)yield a(c)}()}var zt=Dn;function ot(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var st=Bn(Mt(),1);var ye=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},at=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Ot=t=>globalThis.DOMException===void 0?new at(t):new DOMException(t),Ft=t=>{let e=t.reason===void 0?Ot("This operation was aborted."):t.reason;return e instanceof Error?e:Ot(e)};function ct(t,e,r,n){let o,i=new Promise((a,c)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){a(t);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:f}=n;f.aborted&&c(Ft(f)),f.addEventListener("abort",()=>{c(Ft(f))})}o=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{a(r())}catch(w){c(w)}return}let f=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,p=r instanceof Error?r:new ye(f);typeof t.cancel=="function"&&t.cancel(),c(p)},e),(async()=>{try{a(await t)}catch(f){c(f)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()});return i.clear=()=>{clearTimeout(o),o=void 0},i}function ft(t,e,r){let n=0,o=t.length;for(;o>0;){let i=Math.trunc(o/2),a=n+i;r(t[a],e)<=0?(n=++a,o-=i+1):o=i}return n}var re=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},R,ut=class{constructor(){R.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&re(this,R,"f")[this.size-1].priority>=r.priority){re(this,R,"f").push(n);return}let o=ft(re(this,R,"f"),n,(i,a)=>a.priority-i.priority);re(this,R,"f").splice(o,0,n)}dequeue(){let e=re(this,R,"f").shift();return e?.run}filter(e){return re(this,R,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return re(this,R,"f").length}};R=new WeakMap;var jt=ut;var g=function(t,e,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,r):o?o.value=r:e.set(t,r),r},l=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},b,ge,be,J,je,ve,ze,M,xe,I,Le,S,_e,K,Me,Vt,Wt,Ht,Qt,Rt,Oe,dt,ht,Ve,Gt,Fe,We=class extends Error{},lt=class extends st.default{constructor(e){var r,n,o,i;if(super(),b.add(this),ge.set(this,void 0),be.set(this,void 0),J.set(this,0),je.set(this,void 0),ve.set(this,void 0),ze.set(this,0),M.set(this,void 0),xe.set(this,void 0),I.set(this,void 0),Le.set(this,void 0),S.set(this,0),_e.set(this,void 0),K.set(this,void 0),Me.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:jt,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);g(this,ge,e.carryoverConcurrencyCount,"f"),g(this,be,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),g(this,je,e.intervalCap,"f"),g(this,ve,e.interval,"f"),g(this,I,new e.queueClass,"f"),g(this,Le,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,g(this,Me,e.throwOnTimeout===!0,"f"),g(this,K,e.autoStart===!1,"f")}get concurrency(){return l(this,_e,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);g(this,_e,e,"f"),l(this,b,"m",Ve).call(this)}async add(e,r={}){return r={timeout:this.timeout,throwOnTimeout:l(this,Me,"f"),...r},new Promise((n,o)=>{l(this,I,"f").enqueue(async()=>{var i,a,c;g(this,S,(a=l(this,S,"f"),a++,a),"f"),g(this,J,(c=l(this,J,"f"),c++,c),"f");try{if(!((i=r.signal)===null||i===void 0)&&i.aborted)throw new We("The task was aborted.");let f=e({signal:r.signal});r.timeout&&(f=ct(Promise.resolve(f),r.timeout)),r.signal&&(f=Promise.race([f,l(this,b,"m",Gt).call(this,r.signal)]));let p=await f;n(p),this.emit("completed",p)}catch(f){if(f instanceof ye&&!r.throwOnTimeout){n();return}o(f),this.emit("error",f)}finally{l(this,b,"m",Ht).call(this)}},r),this.emit("add"),l(this,b,"m",Oe).call(this)})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return l(this,K,"f")?(g(this,K,!1,"f"),l(this,b,"m",Ve).call(this),this):this}pause(){g(this,K,!0,"f")}clear(){g(this,I,new(l(this,Le,"f")),"f")}async onEmpty(){l(this,I,"f").size!==0&&await l(this,b,"m",Fe).call(this,"empty")}async onSizeLessThan(e){l(this,I,"f").size<e||await l(this,b,"m",Fe).call(this,"next",()=>l(this,I,"f").size<e)}async onIdle(){l(this,S,"f")===0&&l(this,I,"f").size===0||await l(this,b,"m",Fe).call(this,"idle")}get size(){return l(this,I,"f").size}sizeBy(e){return l(this,I,"f").filter(e).length}get pending(){return l(this,S,"f")}get isPaused(){return l(this,K,"f")}};ge=new WeakMap,be=new WeakMap,J=new WeakMap,je=new WeakMap,ve=new WeakMap,ze=new WeakMap,M=new WeakMap,xe=new WeakMap,I=new WeakMap,Le=new WeakMap,S=new WeakMap,_e=new WeakMap,K=new WeakMap,Me=new WeakMap,b=new WeakSet,Vt=function(){return l(this,be,"f")||l(this,J,"f")<l(this,je,"f")},Wt=function(){return l(this,S,"f")<l(this,_e,"f")},Ht=function(){var e;g(this,S,(e=l(this,S,"f"),e--,e),"f"),l(this,b,"m",Oe).call(this),this.emit("next")},Qt=function(){l(this,b,"m",ht).call(this),l(this,b,"m",dt).call(this),g(this,xe,void 0,"f")},Rt=function(){let e=Date.now();if(l(this,M,"f")===void 0){let r=l(this,ze,"f")-e;if(r<0)g(this,J,l(this,ge,"f")?l(this,S,"f"):0,"f");else return l(this,xe,"f")===void 0&&g(this,xe,setTimeout(()=>{l(this,b,"m",Qt).call(this)},r),"f"),!0}return!1},Oe=function(){if(l(this,I,"f").size===0)return l(this,M,"f")&&clearInterval(l(this,M,"f")),g(this,M,void 0,"f"),this.emit("empty"),l(this,S,"f")===0&&this.emit("idle"),!1;if(!l(this,K,"f")){let e=!l(this,b,"a",Rt);if(l(this,b,"a",Vt)&&l(this,b,"a",Wt)){let r=l(this,I,"f").dequeue();return r?(this.emit("active"),r(),e&&l(this,b,"m",dt).call(this),!0):!1}}return!1},dt=function(){l(this,be,"f")||l(this,M,"f")!==void 0||(g(this,M,setInterval(()=>{l(this,b,"m",ht).call(this)},l(this,ve,"f")),"f"),g(this,ze,Date.now()+l(this,ve,"f"),"f"))},ht=function(){l(this,J,"f")===0&&l(this,S,"f")===0&&l(this,M,"f")&&(clearInterval(l(this,M,"f")),g(this,M,void 0,"f")),g(this,J,l(this,ge,"f")?l(this,S,"f"):0,"f"),l(this,b,"m",Ve).call(this)},Ve=function(){for(;l(this,b,"m",Oe).call(this););},Gt=async function(e){return new Promise((r,n)=>{e.addEventListener("abort",()=>{n(new We("The task was aborted."))},{once:!0})})},Fe=async function(e,r){return new Promise(n=>{let o=()=>{r&&!r()||(this.off(e,o),n())};this.on(e,o)})};var qt=lt;function Mn(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var i=t.charAt(o),a=i.charCodeAt(0);if(r[a]!==255)throw new TypeError(i+" is ambiguous");r[a]=o}var c=t.length,f=t.charAt(0),p=Math.log(c)/Math.log(256),w=Math.log(256)/Math.log(c);function m(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var A=0,te=0,z=0,j=x.length;z!==j&&x[z]===0;)z++,A++;for(var V=(j-z)*w+1>>>0,P=new Uint8Array(V);z!==j;){for(var W=x[z],q=0,L=V-1;(W!==0||q<te)&&L!==-1;L--,q++)W+=256*P[L]>>>0,P[L]=W%c>>>0,W=W/c>>>0;if(W!==0)throw new Error("Non-zero carry");te=q,z++}for(var Q=V-te;Q!==V&&P[Q]===0;)Q++;for(var Pe=f.repeat(A);Q<V;++Q)Pe+=t.charAt(P[Q]);return Pe}function ie(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var A=0;if(x[A]!==" "){for(var te=0,z=0;x[A]===f;)te++,A++;for(var j=(x.length-A)*p+1>>>0,V=new Uint8Array(j);x[A];){var P=r[x.charCodeAt(A)];if(P===255)return;for(var W=0,q=j-1;(P!==0||W<z)&&q!==-1;q--,W++)P+=c*V[q]>>>0,V[q]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");z=W,A++}if(x[A]!==" "){for(var L=j-z;L!==j&&V[L]===0;)L++;for(var Q=new Uint8Array(te+(j-L)),Pe=te;L!==j;)Q[Pe++]=V[L++];return Q}}}function ee(x){var A=ie(x);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:ie,decode:ee}}var On=Mn,Fn=On,Kt=Fn;var hi=new Uint8Array(0);var Jt=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ne=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var pt=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},mt=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Xt(this,e)}},wt=class{constructor(e){this.decoders=e}or(e){return Xt(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Xt=(t,e)=>new wt({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),yt=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new pt(e,r,n),this.decoder=new mt(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Yt=({name:t,prefix:e,encode:r,decode:n})=>new yt(t,e,r,n),xt=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=Kt(r,e);return Yt({prefix:t,name:e,encode:n,decode:i=>ne(o(i))})},jn=(t,e,r,n)=>{let o={};for(let w=0;w<e.length;++w)o[e[w]]=w;let i=t.length;for(;t[i-1]==="=";)--i;let a=new Uint8Array(i*r/8|0),c=0,f=0,p=0;for(let w=0;w<i;++w){let m=o[t[w]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|m,c+=r,c>=8&&(c-=8,a[p++]=255&f>>c)}if(c>=r||255&f<<8-c)throw new SyntaxError("Unexpected end of data");return a},Vn=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,i="",a=0,c=0;for(let f=0;f<t.length;++f)for(c=c<<8|t[f],a+=8;a>r;)a-=r,i+=e[o&c>>a];if(a&&(i+=e[o&c<<r-a]),n)for(;i.length*r&7;)i+="=";return i},T=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Yt({prefix:e,name:t,encode(o){return Vn(o,n,r)},decode(o){return jn(o,n,r,t)}});var ke=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xi=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gi=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bi=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vi=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_i=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ki=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ei=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ti=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var H=xt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Si=xt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Wn=tr,Zt=128,Qn=127,Rn=~Qn,Hn=Math.pow(2,31);function tr(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Hn;)e[r++]=t&255|Zt,t/=128;for(;t&Rn;)e[r++]=t&255|Zt,t>>>=7;return e[r]=t|0,tr.bytes=r-n+1,e}var Gn=gt,qn=128,er=127;function gt(t,n){var r=0,n=n||0,o=0,i=n,a,c=t.length;do{if(i>=c)throw gt.bytes=0,new RangeError("Could not decode varint");a=t[i++],r+=o<28?(a&er)<<o:(a&er)*Math.pow(2,o),o+=7}while(a>=qn);return gt.bytes=i-n,r}var Kn=Math.pow(2,7),Jn=Math.pow(2,14),Xn=Math.pow(2,21),Yn=Math.pow(2,28),Zn=Math.pow(2,35),eo=Math.pow(2,42),to=Math.pow(2,49),ro=Math.pow(2,56),no=Math.pow(2,63),oo=function(t){return t<Kn?1:t<Jn?2:t<Xn?3:t<Yn?4:t<Zn?5:t<eo?6:t<to?7:t<ro?8:t<no?9:10},io={encode:Wn,decode:Gn,encodingLength:oo},so=io,Ee=so;var Te=(t,e=0)=>[Ee.decode(t,e),Ee.decode.bytes],se=(t,e,r=0)=>(Ee.encode(t,e,r),e),ae=t=>Ee.encodingLength(t);var nr=(t,e)=>{let r=e.byteLength,n=ae(t),o=n+ae(r),i=new Uint8Array(o+r);return se(t,i,0),se(r,i,n),i.set(e,o),new ce(t,r,e,i)},or=t=>{let e=ne(t),[r,n]=Te(e),[o,i]=Te(e.subarray(n)),a=e.subarray(n+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new ce(r,o,a,e)},ir=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Jt(t.bytes,r.bytes)}},ce=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var sr=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return fo(r,bt(t),e||H.encoder);default:return uo(r,bt(t),e||ke.encoder)}};var ar=new WeakMap,bt=t=>{let e=ar.get(t);if(e==null){let r=new Map;return ar.set(t,r),r}return e},X=class t{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ae)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==ho)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=nr(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&ir(e.multihash,n.multihash)}toString(e){return sr(this,e)}toJSON(){return{"/":sr(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:i,bytes:a}=r;return new t(n,o,i,a||cr(n,o,i.bytes))}else if(r[lo]===!0){let{version:n,multihash:o,code:i}=r,a=or(o);return t.create(n,i,a)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ae)throw new Error(`Version 0 CID must use dag-pb (code: ${Ae}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let o=cr(e,r,n.bytes);return new t(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Ae,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,o=ne(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),a=new ce(r.multihashCode,r.digestSize,i,o);return[r.version===0?t.createV0(a):t.createV1(r.codec,a),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[m,ie]=Te(e.subarray(r));return r+=ie,m},o=n(),i=Ae;if(o===18?(o=0,r=0):i=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let a=r,c=n(),f=n(),p=r+f,w=p-a;return{version:o,codec:i,multihashCode:c,digestSize:f,multihashSize:w,size:p}}static parse(e,r){let[n,o]=co(e,r),i=t.decode(o);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return bt(i).set(n,e),i}},co=(t,e)=>{switch(t[0]){case"Q":{let r=e||H;return[H.prefix,r.decode(`${H.prefix}${t}`)]}case H.prefix:{let r=e||H;return[H.prefix,r.decode(t)]}case ke.prefix:{let r=e||ke;return[ke.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},fo=(t,e,r)=>{let{prefix:n}=r;if(n!==H.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return o},uo=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let i=r.encode(t);return e.set(n,i),i}else return o},Ae=112,ho=18,cr=(t,e,r)=>{let n=ae(t),o=n+ae(e),i=new Uint8Array(o+r.byteLength);return se(t,i,0),se(e,i,n),i.set(r,o),i},lo=Symbol.for("@ipld/js-cid/CID");var po=new TextDecoder;function vt(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let o=t[e++];if(r+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[r,e]}function Qe(t,e){let r;[r,e]=vt(t,e);let n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function fr(t,e){let r;return[r,e]=vt(t,e),[r&7,r>>3,e]}function mo(t){let e={},r=t.length,n=0;for(;n<r;){let o,i;if([o,i,n]=fr(t,n),i===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Qe(t,n)}else if(i===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let a;[a,n]=Qe(t,n),e.Name=po.decode(a)}else if(i===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[e.Tsize,n]=vt(t,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function ur(t){let e=t.length,r=0,n,o=!1,i;for(;r<e;){let c,f;if([c,f,r]=fr(t,r),c!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${c}`);if(f===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,r]=Qe(t,r),n&&(o=!0)}else if(f===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let p;[p,r]=Qe(t,r),n.push(mo(p))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${f}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let a={};return i&&(a.Data=i),a.Links=n||[],a}var Oi=new TextEncoder,Fi=2**32,ji=2**31;var Qi=new TextEncoder;var dr=112;function hr(t){let e=ur(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(n=>{let o={};try{o.Hash=X.decode(n.Hash)}catch{}if(!o.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(o.Name=n.Name),n.Tsize!==void 0&&(o.Tsize=n.Tsize),o})),r}var yo=["string","number","bigint","symbol"],xo=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function lr(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(yo.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(go(t))return"Buffer";let r=bo(t);return r||"Object"}function go(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function bo(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(xo.includes(e))return e}var s=class{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};s.uint=new s(0,"uint",!0);s.negint=new s(1,"negint",!0);s.bytes=new s(2,"bytes",!0);s.string=new s(3,"string",!0);s.array=new s(4,"array",!1);s.map=new s(5,"map",!1);s.tag=new s(6,"tag",!1);s.float=new s(7,"float",!0);s.false=new s(7,"false",!0);s.true=new s(7,"true",!0);s.null=new s(7,"null",!0);s.undefined=new s(7,"undefined",!0);s.break=new s(7,"break",!0);var u=class{constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var fe=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",vo=new TextDecoder,_o=new TextEncoder;function Re(t){return fe&&globalThis.Buffer.isBuffer(t)}function He(t){return t instanceof Uint8Array?Re(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}var yr=fe?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):mr(t,e,r):(t,e,r)=>r-e>64?vo.decode(t.subarray(e,r)):mr(t,e,r),Ge=fe?t=>t.length>64?globalThis.Buffer.from(t):pr(t):t=>t.length>64?_o.encode(t):pr(t);var ue=fe?(t,e,r)=>Re(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),xr=fe?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),He(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),n=0;for(let o of t)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r},gr=fe?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function br(t,e){if(Re(t)&&Re(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function pr(t){let e=[],r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e}function mr(t,e,r){let n=[];for(;e<r;){let o=t[e],i=null,a=o>239?4:o>223?3:o>191?2:1;if(e+a<=r){let c,f,p,w;switch(a){case 1:o<128&&(i=o);break;case 2:c=t[e+1],(c&192)===128&&(w=(o&31)<<6|c&63,w>127&&(i=w));break;case 3:c=t[e+1],f=t[e+2],(c&192)===128&&(f&192)===128&&(w=(o&15)<<12|(c&63)<<6|f&63,w>2047&&(w<55296||w>57343)&&(i=w));break;case 4:c=t[e+1],f=t[e+2],p=t[e+3],(c&192)===128&&(f&192)===128&&(p&192)===128&&(w=(o&15)<<18|(c&63)<<12|(f&63)<<6|p&63,w>65535&&w<1114112&&(i=w))}}i===null?(i=65533,a=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),e+=a}return _t(n)}var wr=4096;function _t(t){let e=t.length;if(e<=wr)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=wr));return r}var ko=256,qe=class{constructor(e=ko){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let o=r.length-(this.maxCursor-this.cursor)-1;r.set(e,o)}else{if(r){let o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=gr(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=ue(n,0,this.cursor)}else r=xr(this.chunks,this.cursor);return e&&this.reset(),r}};var h="CBOR decode error:",de="CBOR encode error:",Ie=[];Ie[23]=1;Ie[24]=2;Ie[25]=3;Ie[26]=5;Ie[27]=9;function G(t,e,r){if(t.length-e<r)throw new Error(`${h} not enough data for type`)}var v=[24,256,65536,4294967296,BigInt("18446744073709551616")];function B(t,e,r){G(t,e,1);let n=t[e];if(r.strict===!0&&n<v[0])throw new Error(`${h} integer encoded in more bytes than necessary (strict decode)`);return n}function U(t,e,r){G(t,e,2);let n=t[e]<<8|t[e+1];if(r.strict===!0&&n<v[1])throw new Error(`${h} integer encoded in more bytes than necessary (strict decode)`);return n}function N(t,e,r){G(t,e,4);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<v[2])throw new Error(`${h} integer encoded in more bytes than necessary (strict decode)`);return n}function C(t,e,r){G(t,e,8);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],o=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&i<v[3])throw new Error(`${h} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(r.allowBigInt===!0)return i;throw new Error(`${h} integers outside of the safe integer range are not supported`)}function vr(t,e,r,n){return new u(s.uint,B(t,e+1,n),2)}function _r(t,e,r,n){return new u(s.uint,U(t,e+1,n),3)}function kr(t,e,r,n){return new u(s.uint,N(t,e+1,n),5)}function Er(t,e,r,n){return new u(s.uint,C(t,e+1,n),9)}function $(t,e){return _(t,0,e.value)}function _(t,e,r){if(r<v[0]){let n=Number(r);t.push([e|n])}else if(r<v[1]){let n=Number(r);t.push([e|24,n])}else if(r<v[2]){let n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<v[3]){let n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<v[4]){let o=[e|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),a=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,t.push(o)}else throw new Error(`${h} encountered BigInt larger than allowable range`)}}$.encodedSize=function(e){return _.encodedSize(e.value)};_.encodedSize=function(e){return e<v[0]?1:e<v[1]?2:e<v[2]?3:e<v[3]?5:9};$.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0};function Tr(t,e,r,n){return new u(s.negint,-1-B(t,e+1,n),2)}function Ar(t,e,r,n){return new u(s.negint,-1-U(t,e+1,n),3)}function Ir(t,e,r,n){return new u(s.negint,-1-N(t,e+1,n),5)}var kt=BigInt(-1),Sr=BigInt(1);function Br(t,e,r,n){let o=C(t,e+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new u(s.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${h} integers outside of the safe integer range are not supported`);return new u(s.negint,kt-BigInt(o),9)}function Ke(t,e){let r=e.value,n=typeof r=="bigint"?r*kt-Sr:r*-1-1;_(t,e.type.majorEncoded,n)}Ke.encodedSize=function(e){let r=e.value,n=typeof r=="bigint"?r*kt-Sr:r*-1-1;return n<v[0]?1:n<v[1]?2:n<v[2]?3:n<v[3]?5:9};Ke.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0};function Se(t,e,r,n){G(t,e,r+n);let o=ue(t,e+r,e+r+n);return new u(s.bytes,o,r+n)}function Ur(t,e,r,n){return Se(t,e,1,r)}function Nr(t,e,r,n){return Se(t,e,2,B(t,e+1,n))}function Cr(t,e,r,n){return Se(t,e,3,U(t,e+1,n))}function Pr(t,e,r,n){return Se(t,e,5,N(t,e+1,n))}function $r(t,e,r,n){let o=C(t,e+1,n);if(typeof o=="bigint")throw new Error(`${h} 64-bit integer bytes lengths not supported`);return Se(t,e,9,o)}function Je(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===s.string?Ge(t.value):t.value),t.encodedBytes}function he(t,e){let r=Je(e);_(t,e.type.majorEncoded,r.length),t.push(r)}he.encodedSize=function(e){let r=Je(e);return _.encodedSize(r.length)+r.length};he.compareTokens=function(e,r){return To(Je(e),Je(r))};function To(t,e){return t.length<e.length?-1:t.length>e.length?1:br(t,e)}function Be(t,e,r,n,o){let i=r+n;G(t,e,i);let a=new u(s.string,yr(t,e+r,e+i),i);return o.retainStringBytes===!0&&(a.byteValue=ue(t,e+r,e+i)),a}function Dr(t,e,r,n){return Be(t,e,1,r,n)}function zr(t,e,r,n){return Be(t,e,2,B(t,e+1,n),n)}function Lr(t,e,r,n){return Be(t,e,3,U(t,e+1,n),n)}function Mr(t,e,r,n){return Be(t,e,5,N(t,e+1,n),n)}function Or(t,e,r,n){let o=C(t,e+1,n);if(typeof o=="bigint")throw new Error(`${h} 64-bit integer string lengths not supported`);return Be(t,e,9,o,n)}var Fr=he;function le(t,e,r,n){return new u(s.array,n,r)}function jr(t,e,r,n){return le(t,e,1,r)}function Vr(t,e,r,n){return le(t,e,2,B(t,e+1,n))}function Wr(t,e,r,n){return le(t,e,3,U(t,e+1,n))}function Qr(t,e,r,n){return le(t,e,5,N(t,e+1,n))}function Rr(t,e,r,n){let o=C(t,e+1,n);if(typeof o=="bigint")throw new Error(`${h} 64-bit integer array lengths not supported`);return le(t,e,9,o)}function Hr(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${h} indefinite length items not allowed`);return le(t,e,1,1/0)}function Xe(t,e){_(t,s.array.majorEncoded,e.value)}Xe.compareTokens=$.compareTokens;Xe.encodedSize=function(e){return _.encodedSize(e.value)};function pe(t,e,r,n){return new u(s.map,n,r)}function Gr(t,e,r,n){return pe(t,e,1,r)}function qr(t,e,r,n){return pe(t,e,2,B(t,e+1,n))}function Kr(t,e,r,n){return pe(t,e,3,U(t,e+1,n))}function Jr(t,e,r,n){return pe(t,e,5,N(t,e+1,n))}function Xr(t,e,r,n){let o=C(t,e+1,n);if(typeof o=="bigint")throw new Error(`${h} 64-bit integer map lengths not supported`);return pe(t,e,9,o)}function Yr(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${h} indefinite length items not allowed`);return pe(t,e,1,1/0)}function Ye(t,e){_(t,s.map.majorEncoded,e.value)}Ye.compareTokens=$.compareTokens;Ye.encodedSize=function(e){return _.encodedSize(e.value)};function Zr(t,e,r,n){return new u(s.tag,r,1)}function en(t,e,r,n){return new u(s.tag,B(t,e+1,n),2)}function tn(t,e,r,n){return new u(s.tag,U(t,e+1,n),3)}function rn(t,e,r,n){return new u(s.tag,N(t,e+1,n),5)}function nn(t,e,r,n){return new u(s.tag,C(t,e+1,n),9)}function Ze(t,e){_(t,s.tag.majorEncoded,e.value)}Ze.compareTokens=$.compareTokens;Ze.encodedSize=function(e){return _.encodedSize(e.value)};var No=20,Co=21,Po=22,$o=23;function on(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${h} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new u(s.null,null,1):new u(s.undefined,void 0,1)}function sn(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${h} indefinite length items not allowed`);return new u(s.break,void 0,1)}function Et(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${h} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${h} Infinity values are not supported`)}return new u(s.float,t,e)}function an(t,e,r,n){return Et(Tt(t,e+1),3,n)}function cn(t,e,r,n){return Et(At(t,e+1),5,n)}function fn(t,e,r,n){return Et(ln(t,e+1),9,n)}function et(t,e,r){let n=e.value;if(n===!1)t.push([s.float.majorEncoded|No]);else if(n===!0)t.push([s.float.majorEncoded|Co]);else if(n===null)t.push([s.float.majorEncoded|Po]);else if(n===void 0)t.push([s.float.majorEncoded|$o]);else{let o,i=!1;(!r||r.float64!==!0)&&(dn(n),o=Tt(O,1),n===o||Number.isNaN(n)?(O[0]=249,t.push(O.slice(0,3)),i=!0):(hn(n),o=At(O,1),n===o&&(O[0]=250,t.push(O.slice(0,5)),i=!0))),i||(Do(n),o=ln(O,1),O[0]=251,t.push(O.slice(0,9)))}}et.encodedSize=function(e,r){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){dn(n);let o=Tt(O,1);if(n===o||Number.isNaN(n))return 3;if(hn(n),o=At(O,1),n===o)return 5}return 9};var un=new ArrayBuffer(9),D=new DataView(un,1),O=new Uint8Array(un,0);function dn(t){if(t===1/0)D.setUint16(0,31744,!1);else if(t===-1/0)D.setUint16(0,64512,!1);else if(Number.isNaN(t))D.setUint16(0,32256,!1);else{D.setFloat32(0,t);let e=D.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)D.setUint16(0,31744,!1);else if(r===0)D.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{let o=r-127;o<-24?D.setUint16(0,0):o<-14?D.setUint16(0,(e&2147483648)>>16|1<<24+o,!1):D.setUint16(0,(e&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Tt(t,e){if(t.length-e<2)throw new Error(`${h} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,o=r&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,r&32768?-i:i}function hn(t){D.setFloat32(0,t,!1)}function At(t,e){if(t.length-e<4)throw new Error(`${h} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function Do(t){D.setFloat64(0,t,!1)}function ln(t,e){if(t.length-e<8)throw new Error(`${h} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}et.compareTokens=$.compareTokens;function y(t,e,r){throw new Error(`${h} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function tt(t){return()=>{throw new Error(`${h} ${t}`)}}var d=[];for(let t=0;t<=23;t++)d[t]=y;d[24]=vr;d[25]=_r;d[26]=kr;d[27]=Er;d[28]=y;d[29]=y;d[30]=y;d[31]=y;for(let t=32;t<=55;t++)d[t]=y;d[56]=Tr;d[57]=Ar;d[58]=Ir;d[59]=Br;d[60]=y;d[61]=y;d[62]=y;d[63]=y;for(let t=64;t<=87;t++)d[t]=Ur;d[88]=Nr;d[89]=Cr;d[90]=Pr;d[91]=$r;d[92]=y;d[93]=y;d[94]=y;d[95]=tt("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)d[t]=Dr;d[120]=zr;d[121]=Lr;d[122]=Mr;d[123]=Or;d[124]=y;d[125]=y;d[126]=y;d[127]=tt("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)d[t]=jr;d[152]=Vr;d[153]=Wr;d[154]=Qr;d[155]=Rr;d[156]=y;d[157]=y;d[158]=y;d[159]=Hr;for(let t=160;t<=183;t++)d[t]=Gr;d[184]=qr;d[185]=Kr;d[186]=Jr;d[187]=Xr;d[188]=y;d[189]=y;d[190]=y;d[191]=Yr;for(let t=192;t<=215;t++)d[t]=Zr;d[216]=en;d[217]=tn;d[218]=rn;d[219]=nn;d[220]=y;d[221]=y;d[222]=y;d[223]=y;for(let t=224;t<=243;t++)d[t]=tt("simple values are not supported");d[244]=y;d[245]=y;d[246]=y;d[247]=on;d[248]=tt("simple values are not supported");d[249]=an;d[250]=cn;d[251]=fn;d[252]=y;d[253]=y;d[254]=y;d[255]=sn;var F=[];for(let t=0;t<24;t++)F[t]=new u(s.uint,t,1);for(let t=-1;t>=-24;t--)F[31-t]=new u(s.negint,t,1);F[64]=new u(s.bytes,new Uint8Array(0),1);F[96]=new u(s.string,"",1);F[128]=new u(s.array,0,1);F[160]=new u(s.map,0,1);F[244]=new u(s.false,!1,1);F[245]=new u(s.true,!0,1);F[246]=new u(s.null,null,1);function Lo(){let t=[];return t[s.uint.major]=$,t[s.negint.major]=Ke,t[s.bytes.major]=he,t[s.string.major]=Fr,t[s.array.major]=Xe,t[s.map.major]=Ye,t[s.tag.major]=Ze,t[s.float.major]=et,t}var Hs=Lo(),Gs=new qe,rt=class t{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${de} object contains circular references`);return new t(r,e)}},Y={null:new u(s.null,null),undefined:new u(s.undefined,void 0),true:new u(s.true,!0),false:new u(s.false,!1),emptyArray:new u(s.array,0),emptyMap:new u(s.map,0)},Z={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new u(s.float,t):t>=0?new u(s.uint,t):new u(s.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new u(s.uint,t):new u(s.negint,t)},Uint8Array(t,e,r,n){return new u(s.bytes,t)},string(t,e,r,n){return new u(s.string,t)},boolean(t,e,r,n){return t?Y.true:Y.false},null(t,e,r,n){return Y.null},undefined(t,e,r,n){return Y.undefined},ArrayBuffer(t,e,r,n){return new u(s.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new u(s.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[Y.emptyArray,new u(s.break)]:Y.emptyArray;n=rt.createCheck(n,t);let o=[],i=0;for(let a of t)o[i++]=It(a,r,n);return r.addBreakTokens?[new u(s.array,t.length),o,new u(s.break)]:[new u(s.array,t.length),o]},Object(t,e,r,n){let o=e!=="Object",i=o?t.keys():Object.keys(t),a=o?t.size:i.length;if(!a)return r.addBreakTokens===!0?[Y.emptyMap,new u(s.break)]:Y.emptyMap;n=rt.createCheck(n,t);let c=[],f=0;for(let p of i)c[f++]=[It(p,r,n),It(o?t.get(p):t[p],r,n)];return Mo(c,r),r.addBreakTokens?[new u(s.map,a),c,new u(s.break)]:[new u(s.map,a),c]}};Z.Map=Z.Object;Z.Buffer=Z.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Z[`${t}Array`]=Z.DataView;function It(t,e={},r){let n=lr(t),o=e&&e.typeEncoders&&e.typeEncoders[n]||Z[n];if(typeof o=="function"){let a=o(t,n,e,r);if(a!=null)return a}let i=Z[n];if(!i)throw new Error(`${de} unsupported type: ${n}`);return i(t,n,e,r)}function Mo(t,e){e.mapSorter&&t.sort(e.mapSorter)}var Oo={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},St=class{constructor(e,r={}){this._pos=0,this.data=e,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let e=this.data[this._pos],r=F[e];if(r===void 0){let n=d[e];if(!n)throw new Error(`${h} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let o=e&31;r=n(this.data,this._pos,o,this.options)}return this._pos+=r.encodedLength,r}},Ue=Symbol.for("DONE"),nt=Symbol.for("BREAK");function Fo(t,e,r){let n=[];for(let o=0;o<t.value;o++){let i=Ne(e,r);if(i===nt){if(t.value===1/0)break;throw new Error(`${h} got unexpected break to lengthed array`)}if(i===Ue)throw new Error(`${h} found array but not enough entries (got ${o}, expected ${t.value})`);n[o]=i}return n}function jo(t,e,r){let n=r.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let a=0;a<t.value;a++){let c=Ne(e,r);if(c===nt){if(t.value===1/0)break;throw new Error(`${h} got unexpected break to lengthed map`)}if(c===Ue)throw new Error(`${h} found map but not enough entries (got ${a} [no key], expected ${t.value})`);if(n!==!0&&typeof c!="string")throw new Error(`${h} non-string keys not supported (got ${typeof c})`);if(r.rejectDuplicateMapKeys===!0&&(n&&i.has(c)||!n&&c in o))throw new Error(`${h} found repeat map key "${c}"`);let f=Ne(e,r);if(f===Ue)throw new Error(`${h} found map but not enough entries (got ${a} [no value], expected ${t.value})`);n?i.set(c,f):o[c]=f}return n?i:o}function Ne(t,e){if(t.done())return Ue;let r=t.next();if(r.type===s.break)return nt;if(r.type.terminal)return r.value;if(r.type===s.array)return Fo(r,t,e);if(r.type===s.map)return jo(r,t,e);if(r.type===s.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let n=Ne(t,e);return e.tags[r.value](n)}throw new Error(`${h} tag not supported (${r.value})`)}throw new Error("unsupported")}function Bt(t,e){if(!(t instanceof Uint8Array))throw new Error(`${h} data to decode must be a Uint8Array`);e=Object.assign({},Oo,e);let r=e.tokenizer||new St(t,e),n=Ne(r,e);if(n===Ue)throw new Error(`${h} did not find any content to decode`);if(n===nt)throw new Error(`${h} got unexpected break`);return[n,t.subarray(r.pos())]}function Ce(t,e){let[r,n]=Bt(t,e);if(n.length>0)throw new Error(`${h} too many terminals, data makes no sense`);return r}var pn=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===s.array&&(r.elements++,r.elements!==1&&e.push([44])),r.type===s.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?e.push([44]):e.push([58]))))}[s.uint.major](e,r){this.prefix(e);let n=String(r.value),o=[];for(let i=0;i<n.length;i++)o[i]=n.charCodeAt(i);e.push(o)}[s.negint.major](e,r){this[s.uint.major](e,r)}[s.bytes.major](e,r){throw new Error(`${de} unsupported type: Uint8Array`)}[s.string.major](e,r){this.prefix(e);let n=Ge(JSON.stringify(r.value));e.push(n.length>32?He(n):n)}[s.array.major](e,r){this.prefix(e),this.inRecursive.push({type:s.array,elements:0}),e.push([91])}[s.map.major](e,r){this.prefix(e),this.inRecursive.push({type:s.map,elements:0}),e.push([123])}[s.tag.major](e,r){}[s.float.major](e,r){if(r.type.name==="break"){let a=this.inRecursive.pop();if(a){if(a.type===s.array)e.push([93]);else if(a.type===s.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${de} unsupported type: undefined`);if(this.prefix(e),r.type.name==="true"){e.push([116,114,117,101]);return}else if(r.type.name==="false"){e.push([102,97,108,115,101]);return}else if(r.type.name==="null"){e.push([110,117,108,108]);return}let n=String(r.value),o=[],i=!1;for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a),!i&&(o[a]===46||o[a]===101||o[a]===69)&&(i=!0);i||(o.push(46),o.push(48)),e.push(o)}};var me=class{constructor(e,r={}){this._pos=0,this.data=e,this.options=r,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${h} unexpected end of input at position ${this._pos}`);for(let r=0;r<e.length;r++)if(this.data[this._pos++]!==e[r])throw new Error(`${h} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this._pos,r=!1,n=!1,o=c=>{for(;!this.done();){let f=this.ch();if(c.includes(f))this._pos++;else break}};if(this.ch()===45&&(r=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new u(s.uint,0,this._pos-e);if(o([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===e+1)throw new Error(`${h} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${h} unexpected token at position ${this._pos}`);n=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));let i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),a=parseFloat(i);return n?new u(s.float,a,this._pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(a)?new u(a>=0?s.uint:s.negint,a,this._pos-e):new u(a>=0?s.uint:s.negint,BigInt(i),this._pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${h} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let i=this._pos,a=0;i<this.data.length&&a<65536;i++,a++){let c=this.data[i];if(c===92||c<32||c>=128)break;if(c===34){let f=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new u(s.string,f,a)}}let e=this._pos,r=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${h} unexpected end of unicode escape sequence at position ${this._pos}`);let i=0;for(let a=0;a<4;a++){let c=this.ch();if(c>=48&&c<=57)c-=48;else if(c>=97&&c<=102)c=c-97+10;else if(c>=65&&c<=70)c=c-65+10;else throw new Error(`${h} unexpected unicode escape character at position ${this._pos}`);i=i*16+c,this._pos++}return i},o=()=>{let i=this.ch(),a=null,c=i>239?4:i>223?3:i>191?2:1;if(this._pos+c>this.data.length)throw new Error(`${h} unexpected unicode sequence at position ${this._pos}`);let f,p,w,m;switch(c){case 1:i<128&&(a=i);break;case 2:f=this.data[this._pos+1],(f&192)===128&&(m=(i&31)<<6|f&63,m>127&&(a=m));break;case 3:f=this.data[this._pos+1],p=this.data[this._pos+2],(f&192)===128&&(p&192)===128&&(m=(i&15)<<12|(f&63)<<6|p&63,m>2047&&(m<55296||m>57343)&&(a=m));break;case 4:f=this.data[this._pos+1],p=this.data[this._pos+2],w=this.data[this._pos+3],(f&192)===128&&(p&192)===128&&(w&192)===128&&(m=(i&15)<<18|(f&63)<<12|(p&63)<<6|w&63,m>65535&&m<1114112&&(a=m))}a===null?(a=65533,c=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|a&1023),r.push(a),this._pos+=c};for(;!this.done();){let i=this.ch(),a;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${h} unexpected string termination at position ${this._pos}`);switch(a=this.ch(),this._pos++,a){case 34:case 39:case 92:case 47:r.push(a);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${h} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new u(s.string,_t(r),this._pos-e);default:if(i<32)throw new Error(`${h} invalid control character at position ${this._pos}`);i<128?(r.push(i),this._pos++):o()}}throw new Error(`${h} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new u(s.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new u(s.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new u(s.null,null,4);case 102:return this.expect([102,97,108,115,101]),new u(s.false,!1,5);case 116:return this.expect([116,114,117,101]),new u(s.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${h} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new u(s.break,void 0,1);if(this.ch()!==44)throw new Error(`${h} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new u(s.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new u(s.break,void 0,1);if(this.ch()!==44)throw new Error(`${h} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new u(s.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${h} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${h} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}};function Ut(t,e){return e=Object.assign({tokenizer:new me(t,e)},e),Ce(t,e)}var mn=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ga=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ba=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),va=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var wn=85;var yn={codec:dr,async*walk(t){yield*hr(t).Links.map(r=>r.Hash)}},xn={codec:wn,async*walk(){}},gn=42,bn={codec:113,async*walk(t){let e=[],r=[];r[gn]=n=>{if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");let o=X.decode(n.subarray(1));return e.push(o),o},Ce(t,{tags:r}),yield*e}},Nt=class extends me{tokenBuffer;constructor(e,r){super(e,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===s.map){let r=this._next();if(r.type===s.string&&r.value==="/"){let n=this._next();if(n.type===s.string){if(this._next().type!==s.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new u(s.tag,42,0)}if(n.type===s.map){let o=this._next();if(o.type===s.string&&o.value==="bytes"){let i=this._next();if(i.type===s.string){for(let c=0;c<2;c++)if(this._next().type!==s.break)throw new Error("Invalid encoded Bytes form");let a=mn.decode(`m${i.value}`);return new u(s.bytes,a,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(o)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return e}},vn={codec:297,async*walk(t){let e=[],r=[];r[gn]=n=>{let o=X.parse(n);return e.push(o),o},Ut(t,{tags:r,tokenizer:new Nt(t,{tags:r,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*e}};var Ro=[xn,yn,bn,vn],Ho=1,Ct=class{components;dagWalkers;constructor(e,r){this.components=e,this.dagWalkers={},[...Ro,...r.dagWalkers??[]].forEach(n=>{this.dagWalkers[n.codec]=n})}async import(e,r){await $t(this.components.blockstore.putMany(zt(e.blocks(),({cid:n,bytes:o})=>({cid:n,block:o})),r))}async export(e,r,n){let o=ot(),i=Array.isArray(e)?e:[e],a=new qt({concurrency:Ho});a.on("idle",()=>{o.resolve()}),a.on("error",c=>{o.resolve(c)});for(let c of i)a.add(async()=>{await this.#e(c,a,async(f,p)=>{await r.put({cid:f,bytes:p})},n)});try{await o.promise}finally{await r.close()}}async#e(e,r,n,o){let i=this.dagWalkers[e.code];if(i==null)throw new Error(`No dag walker found for cid codec ${e.code}`);let a=await this.components.blockstore.get(e,o);await n(e,a);for await(let c of i.walk(a))r.add(async()=>{await this.#e(c,r,n,o)})}};function Go(t,e={}){return new Ct(t,e)}return Un(qo);})();
return HeliaCar}));
